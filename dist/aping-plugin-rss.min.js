
/*! aping-plugin-rss v0.6.1 (03-01-2016) by Jonathan Hornung */
"use strict";var jjtApingRss=angular.module("jtt_aping_rss",[]).directive("apingRss",["apingRssHelper","apingUtilityHelper","rssFactory",function(a,b,c){return{require:"?aping",restrict:"A",replace:"false",link:function(d,e,f,g){var h=g.getAppSettings(),i=b.parseJsonFromAttributes(f.apingRss,a.getThisPlatformString(),h);i.forEach(function(b){var d={model:h.model};"undefined"!=typeof h.getNativeData?d.getNativeData=h.getNativeData:d.getNativeData=!1;var e={v:"1.0",callback:"JSON_CALLBACK"};return"undefined"!=typeof b.items?e.num=b.items:e.num=h.items,0==e.num?!1:(b.path&&(e.q=b.path),(e.num<0||isNaN(e.num))&&(e.num=void 0),void c.getData(e).success(function(b){b&&g.concatToResults(a.getObjectByJsonData(b,d))}))})}}}]);jjtApingRss.factory("rssFactory",["$http",function(a){var b={};return b.getData=function(b){return a.jsonp("//ajax.googleapis.com/ajax/services/feed/load",{method:"GET",params:b})},b}]),jjtApingRss.service("apingRssHelper",["apingModels","apingTimeHelper","apingUtilityHelper",function(a,b,c){this.getThisPlatformString=function(){return"rss"},this.getObjectByJsonData=function(a,b){var c=[];if(a&&a.responseData&&a.responseData.feed&&a.responseData.feed.entries){var d=this;angular.forEach(a.responseData.feed.entries,function(e,f){var g;b.getNativeData===!0||"true"===b.getNativeData?g=e:(e.blog_link=a.responseData.feed.link||a.responseData.feed.feedUrl||void 0,e.blog_author=a.responseData.feed.author||a.responseData.feed.title||void 0,g=d.getItemByJsonData(e,b.model)),g&&c.push(g)})}return c},this.getItemByJsonData=function(a,b){var c={};if(a&&b)switch(b){case"social":c=this.getSocialItemByJsonData(a);break;case"native":c=a;break;default:return!1}return c},this.getSocialItemByJsonData=function(b){var d=a.getNew("social",this.getThisPlatformString());if($.extend(!0,d,{blog_name:b.blog_author||void 0,blog_link:b.blog_link||void 0,post_url:b.link||void 0,source:b.categories&&b.categories.length>0?b.categories:void 0}),b.content?(d.text=c.getTextFromHtml(b.content),d.caption=b.title||void 0):d.text=b.title||void 0,b.content){var e=c.getFirstImageFromHtml(b.content);e.length>1&&(d.img_url=e[1])}return d.date_time=b.publishedDate?new Date(b.publishedDate):void 0,d.timestamp=d.date_time?d.date_time.getTime():void 0,d}}]);